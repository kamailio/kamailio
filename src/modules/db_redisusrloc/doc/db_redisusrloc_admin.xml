<?xml version="1.0" encoding='ISO-8859-1'?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [

<!-- Include general documentation entities -->
<!ENTITY % docentities SYSTEM "../../../../doc/docbook/entities.xml">
%docentities;

]>

<!-- Module User's Guide -->

<chapter>
	
	<title>&adminguide;</title>
	
	<section>
	<title>Overview</title>
	<para>
		This is a module which provides Redis connectivity for Kamailio.
		It implements the DB API defined in Kamailio.The usage of this module 
		might be restricted to usrloc modules.
	</para>
	</section>

	<section id="db_redisusrloc.s.limitations">
	<title>Limitations</title>
	<para>
		This module has implemented the equivalent operations for INSERT, UPDATE, DELETE and SELECT.
		<emphasis> db_mode = 3 of usrloc module in kamailio is used </emphasis>.
		<emphasis> Username based key unique, we do not use ruid etc, thus redis key should be based on username. </emphasis>.
		<emphasis> Multiple registration is not allowed for same user with different contacts, only one registration per contact. </emphasis>.
	</para>
	</section>

	<section>
	<title>Dependencies</title>
	<section>
		<title>&kamailio; Modules</title>
		<para>
		The following modules must be loaded before this module:
			<itemizedlist>
			<listitem>
			<para>
				<emphasis>No dependencies on other &kamailio; modules</emphasis>.
			</para>
			</listitem>
			</itemizedlist>
		</para>
	</section>
	<section>
		<title>External Libraries or Applications</title>
		<para>
		The following libraries or applications must be installed before running
		&kamailio; with this module loaded:
			<itemizedlist>
			<listitem>
			<para>
				<emphasis>Redis - "libhiredis>0.13.3". </emphasis> 
				Below key should be included into redis:
                		Hmset kamailio:table_version  location "8"
			</para>
			</listitem>
			</itemizedlist>
		</para>
	</section>
	</section>
	<section>
	<title>Usage</title>
		<para>
			Load the module and set the the DB URL for specific modules to:
			redis://password@host:port/database.
		</para>
		<example>
		<title>Usage</title>
		<programlisting format="linespecific">
...
loadmodule "db_redisusrloc.so"
...
#!define DBURL "redis://password@localhost:6379/0"
modparam("usrloc", "db_url", DBURL)
...
</programlisting>
		</example>
	</section>
</chapter>
