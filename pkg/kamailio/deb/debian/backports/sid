#!/bin/bash
#
# Target dist: Debian Sid
DIST=sid

rm -rf ${DIST}
cp -r debian ${DIST}

# no python2
sed -i -e '/^ python,/d' -e '/python-dev/d' \
  -e '/^Package: kamailio-python-modules/,/^$/d' \
  ${DIST}/control
sed -i -e '/^PACKAGE_GROUPS += python$/d' ${DIST}/rules
sed -i -e '/--EXCLUDED--/i EXTRA_EXCLUDED_MODULES += python' ${DIST}/rules

# no lsb-base
sed -i -e '/lsb-base/d' ${DIST}/control

# libncurses
sed -i -e 's/libncurses5-dev/libncurses-dev/g' ${DIST}/control

# no db5.3
rm ${DIST}/kamailio-berkeley-bin.dirs \
  ${DIST}/kamailio-berkeley-modules.cmake-components
sed -i -e '/libdb-dev/d' \
  -e '/^Package: kamailio-berkeley-modules/,/^$/d' \
  -e '/^Package: kamailio-berkeley-bin/,/^$/d' \
  ${DIST}/control
sed -i -e '/^PACKAGE_GROUPS += berkeley$/d' ${DIST}/rules
sed -i -e '/--EXCLUDED--/i EXTRA_EXCLUDED_MODULES += berkeley' ${DIST}/rules

wrap-and-sort -sat -d ${DIST}

# clean backports scripts
rm -rf ${DIST}/backports
exit 0
